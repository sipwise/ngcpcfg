#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
# export DH_VERBOSE=1

%:
	dh $@

override_dh_auto_build:
	dh_testdir
	$(MAKE) man
	# catch any syntax errors *before* building the .deb
	$(MAKE) syntaxcheck

override_dh_install:
	dh_install
	test -r $(CURDIR)/usr/sbin/ngcp-network && \
		sed -i -e "s/VERSION = 'UNRELEASED'/VERSION = '$(VERSION)'/" \
		$(CURDIR)/usr/sbin/ngcp-network || true

override_dh_auto_test:
	mkdir -p /var/run
	dh_auto_test
	if [ -d /build/ ] ; then find $(CURDIR)/results/ -name pytest.xml -exec cp {} /build/ \; || true ; fi
	if [ -d /tmp/buildd/ ] ; then find $(CURDIR)/results/ -name pytest.xml -exec cp {} /tmp/buildd/ \; || true ; fi
	#find $(CURDIR)/results/ -name pytest.xml -exec cp {} /build/ \; || true
	# find $(CURDIR) -name pytest.xml -exec echo cp {} $(BUILDDIR) \; || true
	ls /build/ || true
	ls /tmp/buildd/ || true
